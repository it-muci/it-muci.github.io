<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…³äºæˆ‘</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* é€šç”¨æ ·å¼å’Œå­—ä½“ */
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            overflow: hidden; /* é˜²æ­¢æ»šåŠ¨æ¡ */
            background: url('https://4kwallpapers.com/images/walls/thumbs_2t/5893.jpg') no-repeat center center fixed; /* macOS å£çº¸ */
            background-size: cover;
            color: #fff;
            cursor: default;
            /* ç¦ç”¨iOSå¼¹æ€§æ»šåŠ¨ï¼Œé¿å…ä¸é¡µé¢æ‹–æ‹½å†²çª */
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y; /* å…è®¸å‚ç›´æ»šåŠ¨ï¼Œä½†å¯ä»¥è¢«JSè¦†ç›– */
        }

        /* é¡¶éƒ¨èœå•æ  (macOS æ ·å¼) */
        .menu-bar {
            background-color: rgba(0, 0, 0, 0.6); /* åŠé€æ˜é»‘è‰² */
            backdrop-filter: blur(10px); /* ç£¨ç ‚æ•ˆæœ */
            color: #f0f0f0;
            height: 22px;
            display: flex; /* Default display */
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
            font-size: 13px;
            user-select: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .menu-left, .menu-right {
            display: flex;
            align-items: center;
        }

        .apple-logo {
            font-size: 16px;
            margin-right: 15px;
        }

        .menu-item {
            padding: 0 8px;
            cursor: pointer;
        }

        .menu-item.active, .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .menu-icon {
            margin-left: 10px;
        }

        /* æ¡Œé¢åŒºåŸŸ (macOS æ ·å¼) */
        .desktop {
            position: absolute;
            top: 22px; /* èœå•æ é«˜åº¦ */
            bottom: 0;
            left: 0;
            right: 0;
            display: flex; /* Default display */
            flex-wrap: wrap;
            align-content: flex-start; /* å›¾æ ‡ä»é¡¶éƒ¨å¼€å§‹æ’åˆ— */
            padding: 20px;
            perspective: 1000px; /* For 3D transforms */
            overflow: hidden; /* Prevent desktop scrolling */
        }

        .desktop-icon {
            width: 80px;
            text-align: center;
            margin: 10px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #fff;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            user-select: none;
            transition: transform 0.1s ease-out; /* For hover/active states */
            position: relative; /* For context menu positioning */
        }
        .desktop-icon.dragging {
            opacity: 0.7;
            cursor: grabbing;
        }

        /* Font Awesome å›¾æ ‡æ ·å¼è°ƒæ•´ */
        .desktop-icon .fa-solid, .desktop-icon .fa-brands {
            font-size: 64px; /* æ¡Œé¢å›¾æ ‡å°ºå¯¸ */
            margin-bottom: 5px;
        }

        /* åº•éƒ¨ Dock æ  (macOS æ ·å¼) */
        .dock {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.3); /* Optimized transparency */
            backdrop-filter: blur(20px); /* Optimized blur */
            border-radius: 15px;
            padding: 5px 10px;
            display: flex; /* Default display */
            align-items: flex-end; /* ä½¿å›¾æ ‡åº•éƒ¨å¯¹é½ */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.05); /* Optimized shadow and inner highlight */
            border: 1px solid rgba(255, 255, 255, 0.1); /* Subtle light border */
            z-index: 999;
            will-change: transform; /* Hint for performance */
        }

        .dock-item {
            margin: 0 5px;
            text-align: center;
            cursor: pointer;
            position: relative;
            padding-bottom: 5px; /* ä¸ºæ–‡å­—ç•™å‡ºç©ºé—´ */
            transform-origin: bottom; /* ç¼©æ”¾æ—¶ä»åº•éƒ¨å¼€å§‹ */
            transition: transform 0.1s ease-out; /* Smooth transition for scaling */
        }

        /* Font Awesome å›¾æ ‡æ ·å¼è°ƒæ•´ï¼šDock æ é»˜è®¤å°ºå¯¸ */
        .dock-item .fa-solid, .dock-item .fa-brands {
            font-size: 40px; /* é»˜è®¤å°ºå¯¸ä» 50px ç¼©å°åˆ° 40px */
            display: block;
            transition: transform 0.1s ease-out; /* ä¸ºå›¾æ ‡æœ¬èº«æ·»åŠ è¿‡æ¸¡ */
        }

        .dock-item span {
            display: block; /* Always render, but control visibility with opacity */
            opacity: 0;
            pointer-events: none; /* Prevent interaction when hidden */
            transition: opacity 0.2s ease-out, bottom 0.2s ease-out; /* Add transition for tooltip */
            color: #fff;
            font-size: 11px;
            position: absolute;
            bottom: -20px; /* Start a bit lower for slide-up effect */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            padding: 2px 5px;
            border-radius: 3px;
            white-space: nowrap;
        }

        /* Dock æ æ‚¬åœæ—¶å›¾æ ‡æ”¾å¤§æ•ˆæœ */
        .dock-item:hover span {
            opacity: 1; /* Fade in */
            bottom: -15px; /* Slide up to final position */
        }

        /* æ¨¡æ€çª—å£ */
        .modal-window {
            background-color: rgba(230, 230, 230, 0.95); /* æ›´æ¥è¿‘ macOS çª—å£çš„èƒŒæ™¯è‰² */
            backdrop-filter: blur(15px); /* å¼ºåŒ–ç£¨ç ‚æ•ˆæœ */
            border-radius: 10px; /* æ›´å¤§çš„åœ†è§’ */
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3); /* æ›´æ·±çš„é˜´å½± */
            width: 600px;
            height: 400px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8); /* Initial scale for bounce-in */
            opacity: 0; /* Initially hidden */
            display: flex; /* Default display */
            flex-direction: column;
            overflow: hidden;
            color: #333;
            resize: both; /* å…è®¸è°ƒæ•´å¤§å° */
            min-width: 300px;
            min-height: 200px;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease-out; /* Bounce transition */
            z-index: 997; /* Default z-index */
            will-change: transform, opacity; /* Hint for performance */
        }

        .modal-window.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .modal-window.minimizing {
            transform: translate(-50%, 100vh) scale(0.1); /* Animate to bottom right */
            opacity: 0;
        }

        .modal-window.hidden {
            display: none; /* Truly hide after animation */
        }

        /* çª—å£æ ‡é¢˜æ  */
        .window-header {
            background-color: #e0e0e0;
            background: linear-gradient(to bottom, #e0e0e0, #d0d0d0); /* æ¸å˜æ•ˆæœ */
            border-bottom: 1px solid #c0c0c0; /* æ›´ç»†çš„åº•éƒ¨è¾¹æ¡† */
            border-top-left-radius: 10px; /* é…åˆçª—å£åœ†è§’ */
            border-top-right-radius: 10px; /* é…åˆçª—å£åœ†è§’ */
            padding: 8px 10px;
            display: flex;
            align-items: center;
            justify-content: center; /* æ ‡é¢˜å±…ä¸­ */
            position: relative;
            cursor: grab; /* å¯æ‹–æ‹½ */
            user-select: none; /* é˜²æ­¢æ‹–æ‹½æ—¶é€‰ä¸­æ–‡å­— */
            flex-shrink: 0; /* Prevent header from shrinking */
        }

        /* çª—å£æ§åˆ¶æŒ‰é’® */
        .window-controls {
            position: absolute;
            left: 12px; /* ç¨ä½œè°ƒæ•´ï¼Œæ›´åƒ macOS */
            display: flex;
            align-items: center;
        }

        .window-controls span {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px; /* æŒ‰é’®é—´è· */
            cursor: pointer;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 1px rgba(0, 0, 0, 0.1); /* æŒ‰é’®å†…éƒ¨é«˜å…‰å’Œå¤–éƒ¨é˜´å½± */
            transition: background-color 0.1s ease-in-out; /* æ‚¬åœåŠ¨ç”» */
            position: relative; /* For pseudo-elements */
        }

        /* æŒ‰é’®é¢œè‰²å’Œæ‚¬åœæ•ˆæœ */
        .close-btn { background-color: #ff5f56; } /* çº¢è‰²å…³é—­æŒ‰é’® */
        .minimize-btn { background-color: #ffbd2e; } /* é»„è‰²æœ€å°åŒ–æŒ‰é’® */
        .maximize-btn { background-color: #27c93f; } /* ç»¿è‰²æœ€å¤§åŒ–æŒ‰é’® */

        .window-controls span:hover {
            opacity: 0.8; /* æ‚¬åœæ—¶ç¨å¾®é€æ˜ */
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3), 0 1px 2px rgba(0, 0, 0, 0.15); /* æ‚¬åœæ—¶é˜´å½±å˜åŒ– */
        }

        /* é¼ æ ‡æ‚¬åœåœ¨æ§åˆ¶æŒ‰é’®ä¸Šæ—¶æ˜¾ç¤ºå°åœ†ç‚¹ */
        .close-btn:hover::before {
            content: '\f00d';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 9px;
            color: rgba(100, 0, 0, 0.8);
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            display: block;
        }
        .minimize-btn:hover::before {
            content: '\f068';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 9px;
            color: rgba(100, 70, 0, 0.8);
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            display: block;
        }
        .maximize-btn:hover::before {
            content: '\f065';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 9px;
            color: rgba(0, 100, 0, 0.8);
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            display: block;
        }

        /* éšè—é»˜è®¤æ˜¾ç¤ºçš„å°åœ†ç‚¹ */
        .window-controls span::before {
            display: none;
        }

        .window-title {
            font-weight: 600;
            font-size: 14px;
            color: #555;
        }

        .window-content {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            color: #444;
            background-color: #f5f5f5; /* çª—å£å†…å®¹åŒºèƒŒæ™¯ */
            border-bottom-left-radius: 10px; /* é…åˆçª—å£åœ†è§’ */
            border-bottom-right-radius: 10px; /* é…åˆçª—å£åœ†è§’ */
            -webkit-overflow-scrolling: touch; /* å¯ç”¨iOSå¹³æ»‘æ»šåŠ¨ */
        }
        .project-item {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #eee;
        }
        .project-item:last-child {
            border-bottom: none;
        }
        .project-item h4 {
            margin-top: 0;
            margin-bottom: 5px;
            color: #333;
        }
        .project-item p {
            margin-bottom: 5px;
        }
        .project-item a {
            color: #007aff;
            text-decoration: none;
        }
        .project-item a:hover {
            text-decoration: underline;
        }

        /* Context Menu (Right-Click Menu) */
        .context-menu {
            position: absolute;
            background-color: rgba(230, 230, 230, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 5px 0;
            min-width: 150px;
            z-index: 1001; /* Above everything */
            display: none; /* Hidden by default */
            color: #333;
        }

        .context-menu-item {
            padding: 8px 15px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }

        .context-menu-item:hover {
            background-color: #007aff;
            color: #fff;
        }

        .context-menu-separator {
            height: 1px;
            background-color: rgba(0, 0, 0, 0.1);
            margin: 5px 0;
        }

        /* --- macOS Boot Screen Overlay --- */
        .macos-boot-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1a1a1a; /* Dark background like macOS boot */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000; /* Ensure it's on top */
            transition: opacity 1s ease-out; /* Fade out effect */
        }

        .macos-boot-overlay.hidden {
            opacity: 0;
            pointer-events: none; /* Allow click-through */
            display: none; /* Crucial: completely remove from layout */
        }

        .apple-logo-boot {
            font-size: 80px; /* Larger Apple logo */
            color: #f0f0f0;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-out; /* Fade in the logo */
        }

        .progress-bar-container {
            width: 300px;
            height: 6px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            animation: fadeIn 1s ease-out 0.5s forwards; /* Fade in after logo */
            opacity: 0; /* Initially hidden */
        }

        .progress-bar {
            width: 0%;
            height: 100%;
            background-color: #f0f0f0;
            border-radius: 3px;
            animation: fillProgress 4s ease-in-out forwards; /* Fill animation */
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fillProgress {
            from { width: 0%; }
            to { width: 100%; }
        }

        /* --- ç§»åŠ¨ç«¯ï¼ˆiOS æ ·å¼ï¼‰ --- */
        @media (max-width: 768px) {
            body {
                background-size: cover; /* iOS é£æ ¼çš„èƒŒæ™¯è‰²ï¼Œæ¨¡æ‹Ÿä¸»å±å¹•èƒŒæ™¯ */
                background-color: #2b3a4a;
                background-image: url("https://p2.itc.cn/q_70/images03/20211022/e036ad68796a4c7285f78f965702e320.png"); /* ç§»åŠ¨ç«¯ä¸ä½¿ç”¨ macOS å£çº¸ï¼Œæˆ–è€…ä½¿ç”¨ iOS é£æ ¼å£çº¸ */
                overscroll-behavior-y: contain; /* é˜²æ­¢èƒŒæ™¯æ»šåŠ¨ */
            }

            /* éšè— macOS èœå•æ  */
            .menu-bar {
                display: none; /* Hide macOS elements on mobile */
            }

            /* æ¨¡æ‹Ÿ iOS çŠ¶æ€æ  */
            .ios-status-bar {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 40px; /* iOS çŠ¶æ€æ é«˜åº¦ */
                background-color: rgba(0, 0, 0, 0.2); /* åŠé€æ˜èƒŒæ™¯ */
                backdrop-filter: blur(10px);
                color: #fff;
                display: flex; /* Default display for iOS status bar */
                justify-content: space-between;
                align-items: center;
                padding: 0 15px;
                font-size: 13px;
                z-index: 1000;
                font-weight: 600; /* iOS çŠ¶æ€æ å­—ä½“æ›´ç²— */
                -webkit-app-region: drag; /* æ¨¡æ‹Ÿå¯æ‹–æ‹½åŒºåŸŸ */
            }

            .ios-status-bar .time {
                font-weight: 600;
            }

            .ios-status-bar .icons {
                display: flex;
                align-items: center;
            }

            .ios-status-bar .icons i {
                margin-left: 8px;
                font-size: 14px;
            }
            .ios-status-bar .icons .fa-battery-full {
                position: relative;
                width: 25px; /* ç”µæ± å›¾æ ‡å®½åº¦ */
                height: 12px; /* ç”µæ± å›¾æ ‡é«˜åº¦ */
                border: 1px solid rgba(255, 255, 255, 0.7);
                border-radius: 3px;
                margin-left: 10px;
                font-size: 0; /* éšè— Font Awesome é»˜è®¤ç”µæ± å›¾æ ‡ */
            }
            .ios-status-bar .icons .fa-battery-full::before {
                content: '';
                position: absolute;
                top: 1px;
                left: 1px;
                bottom: 1px;
                width: 70%; /* æ¨¡æ‹Ÿç”µæ± ç”µé‡ */
                background-color: #fff;
                border-radius: 2px;
            }
            .ios-status-bar .icons .fa-battery-full::after {
                content: '';
                position: absolute;
                top: 3px;
                right: -4px;
                width: 2px;
                height: 6px;
                background-color: rgba(255, 255, 255, 0.7);
                border-radius: 0 1px 1px 0;
            }

            /* æ¡Œé¢åŒºåŸŸè°ƒæ•´ä¸º iOS åº”ç”¨ç½‘æ ¼ */
            .desktop {
                top: 40px; /* çŠ¶æ€æ é«˜åº¦ */
                bottom: 80px; /* Dock æ å’Œ Home æŒ‡ç¤ºæ¡é«˜åº¦ */
                padding: 20px 10px;
                align-content: flex-start;
                justify-content: center; /* å±…ä¸­æ’åˆ—å›¾æ ‡ */
                display: flex; /* Default display for iOS desktop */
                flex-wrap: wrap; /* Allow icons to wrap */
                overflow-y: auto; /* Enable scrolling for icons */
                -webkit-overflow-scrolling: touch; /* Smooth iOS scrolling */
            }

            .desktop-icon {
                width: 75px; /* iOS åº”ç”¨å›¾æ ‡å¤§å° */
                height: 90px; /* åŒ…å«æ ‡é¢˜çš„é«˜åº¦ */
                margin: 8px; /* é—´è· */
                color: #fff;
                text-shadow: none; /* iOS å›¾æ ‡æ²¡æœ‰é˜´å½±æ–‡å­— */
                flex-shrink: 0; /* Prevent icons from shrinking */
                touch-action: none; /* Enable custom drag */
            }

            .desktop-icon .fa-solid, .desktop-icon .fa-brands {
                font-size: 55px; /* iOS åº”ç”¨å›¾æ ‡è§†è§‰å¤§å° */
                width: 60px; /* èƒŒæ™¯å®¹å™¨å¤§å° */
                height: 60px; /* æ¨¡æ‹Ÿ iOS å›¾æ ‡èƒŒæ™¯è‰²å’Œè¾¹æ¡† */
                background-color: rgba(255, 255, 255, 0.2);
                border-radius: 18%; /* iOS å…¸å‹çš„â€œæ–¹åœ†â€å›¾æ ‡ */
                display: flex;
                justify-content: center;
                align-items: center;
                margin-bottom: 5px;
                overflow: hidden; /* ç¡®ä¿å›¾æ ‡è¶…å‡ºéƒ¨åˆ†è¢«è£å‰ª */
                box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1), 0 2px 5px rgba(0, 0, 0, 0.2); /* è½»å¾®å†…é˜´å½±å’Œå¤–é˜´å½± */
            }

            .desktop-icon span {
                font-size: 11px;
                text-align: center;
                line-height: 1.2;
                max-width: 100%; /* Prevent text overflow */
                white-space: normal; /* Allow text to wrap if too long */
                word-break: break-word; /* Break long words */
            }

            /* Dock æ è°ƒæ•´ä¸º iOS Dock */
            .dock {
                bottom: 50px; /* é¡¶éƒ¨çŠ¶æ€æ ã€Dockã€Home æŒ‡ç¤ºæ¡çš„é«˜åº¦å¸ƒå±€ */
                height: 70px; /* iOS Dock çš„é«˜åº¦ */
                width: 90%; /* å®½åº¦å æ»¡ */
                bottom: 15px;
                max-width: 380px; /* æœ€å¤§å®½åº¦ */
                border-radius: 18px; /* iOS Dock çš„åœ†è§’ */
                padding: 5px 10px;
                align-items: center; /* å‚ç›´å±…ä¸­å›¾æ ‡ */
                justify-content: space-around; /* å‡åŒ€åˆ†å¸ƒå›¾æ ‡ */
                transform: translateX(-50%); /* ç¡®ä¿æ°´å¹³å±…ä¸­ */
                box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3); /* è°ƒæ•´Docké˜´å½± */
                background-color: rgba(0, 0, 0, 0.3); /* è°ƒæ•´DockèƒŒæ™¯é€æ˜åº¦ */
                border: none; /* Remove border for iOS dock */
            }

            .dock-item {
                margin: 0; /* ç§»é™¤é¢å¤–è¾¹è· */
                padding-bottom: 0; /* ç§»é™¤æ–‡å­—ç•™ç™½ */
                transition: none; /* ç§»é™¤æ‚¬åœåŠ¨ç”» */
            }

            .dock-item .fa-solid, .dock-item .fa-brands {
                font-size: 48px; /* iOS Dock å›¾æ ‡å°ºå¯¸ */
                width: 60px; /* èƒŒæ™¯å®¹å™¨å¤§å° */
                height: 60px;
                background-color: rgba(255, 255, 255, 0.2); /* æ¨¡æ‹Ÿå›¾æ ‡èƒŒæ™¯è‰² */
                border-radius: 18%; /* iOS å…¸å‹çš„â€œæ–¹åœ†â€å›¾æ ‡ */
                display: flex;
                justify-content: center;
                align-items: center;
                transform: scale(1); /* ç§»é™¤æ‚¬åœæ—¶çš„æ”¾å¤§ */
                transition: none;
                box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1), 0 2px 5px rgba(0, 0, 0, 0.2); /* è½»å¾®å†…é˜´å½±å’Œå¤–é˜´å½± */
            }

            .dock-item span {
                display: none; /* ç§»åŠ¨ç«¯ Dock ä¸æ˜¾ç¤ºæ–‡å­— */
            }

            .dock-item:hover {
                transform: none; /* ç§»é™¤æ‚¬åœæŠ¬èµ·æ•ˆæœ */
            }

            .dock-item:hover + .dock-item, .dock-item:hover + .dock-item + .dock-item {
                transform: none; /* ç§»é™¤ç›¸é‚»å›¾æ ‡çš„ç¼©æ”¾ */
            }

            .dock-item:hover .fa-solid, .dock-item:hover .fa-brands {
                transform: scale(1); /* ç§»é™¤æ‚¬åœæ”¾å¤§ */
            }

            /* æ¨¡æ‹Ÿ Home æŒ‡ç¤ºæ¡ */
            .ios-home-indicator {
                position: fixed;
                bottom: 8px; /* åº•éƒ¨ä½ç½® */
                left: 50%;
                transform: translateX(-50%);
                width: 130px; /* æŒ‡ç¤ºæ¡å®½åº¦ */
                height: 4px; /* æŒ‡ç¤ºæ¡é«˜åº¦ */
                background-color: rgba(255, 255, 255, 0.7); /* ç™½è‰²åŠé€æ˜ */
                border-radius: 2px;
                z-index: 1000;
                display: block; /* Default display */
            }

            /* æ¨¡æ€çª—å£è°ƒæ•´ä¸º iOS é£æ ¼çš„å¼¹çª— */
            .modal-window {
                width: 90%; /* å æ®å¤§éƒ¨åˆ†å±å¹•å®½åº¦ */
                height: 80%; /* å æ®å¤§éƒ¨åˆ†å±å¹•é«˜åº¦ */
                border-radius: 15px; /* æ›´å¤§çš„åœ†è§’ */
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* æŸ”å’Œé˜´å½± */
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0.8); /* Initial scale for bounce-in */
                opacity: 0;
                transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease-out; /* iOS é£æ ¼çš„æ‰“å¼€åŠ¨ç”» */
                touch-action: pan-y; /* å…è®¸çª—å£å†…å®¹æ»šåŠ¨ */
            }

            .modal-window.active {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }

            /* éšè— desktop åŒºåŸŸçš„æ»šåŠ¨æ¡ */
            .desktop::-webkit-scrollbar {
                display: none;
            }
            .desktop {
                -ms-overflow-style: none; /* IE and Edge */
                scrollbar-width: none; /* Firefox */
            }

            .window-header {
                background: linear-gradient(to bottom, #f0f0f0, #e0e0e0); /* iOS æ ‡é¢˜æ æ¸å˜ */
                border-bottom: 1px solid #d0d0d0;
                height: 44px; /* iOS å¯¼èˆªæ é«˜åº¦ */
                padding: 0 10px;
                border-top-left-radius: 15px;
                border-top-right-radius: 15px;
                position: relative; /* ç¡®ä¿å­å…ƒç´ å¯ä»¥å®šä½ */
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: default; /* ç§»åŠ¨ç«¯æ ‡é¢˜æ ä¸å¯æ‹–æ‹½ */
            }

            .window-controls {
                display: none; /* iOS å¼¹çª—é€šå¸¸æ²¡æœ‰çº¢é»„ç»¿æŒ‰é’® */
            }

            .window-title {
                font-size: 17px;
                font-weight: 600;
                color: #333;
                position: static; /* æ¢å¤é™æ€å®šä½ */
                transform: none; /* ç§»é™¤åç§» */
            }

            /* åœ¨ç§»åŠ¨ç«¯æ¨¡æ€çª—å£ä¸­æ·»åŠ ä¸€ä¸ªå…³é—­æŒ‰é’® */
            .modal-window .close-button-mobile {
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
                color: #007aff; /* iOS è“è‰² */
                font-size: 16px;
                cursor: pointer;
                font-weight: normal;
                display: block; /* Default display */
            }

            .window-content {
                padding: 15px;
                border-bottom-left-radius: 15px;
                border-bottom-right-radius: 15px;
                overflow-y: auto; /* ç¡®ä¿å†…å®¹å¯ä»¥æ»šåŠ¨ */
                -webkit-overflow-scrolling: touch; /* å¯ç”¨iOSå¹³æ»‘æ»šåŠ¨ */
            }

            /* Hide context menu on mobile */
            .context-menu {
                display: none !important;
            }

            /* --- iOS Boot Screen Overlay (Mobile Specific) --- */
            .ios-boot-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: #000; /* Black background like iOS boot */
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 2000; /* Ensure it's on top */
                transition: opacity 0.5s ease-out; /* Faster fade out */
            }

            .ios-boot-overlay.hidden {
                opacity: 0;
                pointer-events: none;
                display: none; /* Crucial: completely remove from layout */
            }

            .apple-logo-ios {
                font-size: 100px; /* Larger Apple logo for iOS */
                color: #f0f0f0;
                animation: iosLogoFadeIn 1.5s ease-in-out forwards; /* Fade in and stay */
                opacity: 0; /* Initially hidden */
            }

            @keyframes iosLogoFadeIn {
                0% { opacity: 0; transform: scale(0.8); }
                50% { opacity: 1; transform: scale(1); }
                100% { opacity: 1; transform: scale(1); }
            }
        }
    </style>
</head>
<body>

    <div class="macos-boot-overlay" id="boot-overlay-macos">
        <span class="apple-logo-boot"><i class="fa-brands fa-apple"></i></span>
        <div class="progress-bar-container">
            <div class="progress-bar"></div>
        </div>
    </div>

    <div class="ios-boot-overlay" id="boot-overlay-ios" style="display: none;">
        <span class="apple-logo-ios"><i class="fa-brands fa-apple"></i></span>
    </div>

    <div id="main-content-wrapper" style="display: none;">
        <div class="menu-bar">
            <div class="menu-left">
                <span class="apple-logo"><i class="fa-brands fa-apple"></i></span>
                <span class="menu-item active">Finder</span>
                <span class="menu-item">æ–‡ä»¶</span>
                <span class="menu-item">ç¼–è¾‘</span>
                <span class="menu-item">è§†å›¾</span>
                <span class="menu-item">å‰å¾€</span>
                <span class="menu-item">çª—å£</span>
                <span class="menu-item">å¸®åŠ©</span>
            </div>
            <div class="menu-right">
                <i class="fas fa-wifi menu-icon"></i>
                <i class="fas fa-search menu-icon"></i>
                <i class="fas fa-battery-half menu-icon"></i>
                <i class="fas fa-control-tower menu-icon"></i>
                <span class="menu-item time" id="current-time"></span>
            </div>
        </div>

        <div class="ios-status-bar" style="display: none;">
            <span class="time" id="ios-current-time"></span>
            <div class="icons">
                <i class="fas fa-wifi"></i>
                <i class="fas fa-battery-full"></i>
            </div>
        </div>

        <div class="desktop" id="desktop">
            <div class="desktop-icon" id="about-me-icon" data-modal-target="about-me-modal">
                <i class="fa-solid fa-user-circle"></i>
                <span>å…³äºæˆ‘</span>
            </div>
            <div class="desktop-icon" id="portfolio-icon" data-modal-target="portfolio-modal">
                <i class="fa-solid fa-folder-open"></i>
                <span>ä½œå“é›†</span>
            </div>
            <div class="desktop-icon" id="contact-icon" data-modal-target="contact-modal">
                <i class="fa-solid fa-envelope"></i>
                <span>è”ç³»æˆ‘</span>
            </div>
            <div class="desktop-icon" id="change-bg-icon">
                <i class="fa-solid fa-image"></i>
                <span>æ¢å£çº¸</span>
            </div>
        </div>

        <div class="dock" id="dock">
            <div class="dock-item" data-target="about-me-modal">
                <i class="fa-solid fa-globe"></i>
                <span>å…³äºæˆ‘</span>
            </div>
            <div class="dock-item" data-target="portfolio-modal">
                <i class="fa-solid fa-image"></i>
                <span>ä½œå“é›†</span>
            </div>
            <div class="dock-item">
                <a href="https://github.com/your-github" target="_blank" style="text-decoration: none; color: inherit;">
                    <i class="fa-brands fa-github"></i>
                    <span>GitHub</span>
                </a>
            </div>
            <div class="dock-item" data-target="contact-modal">
                <i class="fa-solid fa-paper-plane"></i>
                <span>è”ç³»æˆ‘</span>
            </div>
            <div class="dock-item">
                <a href="https://your-blog.com" target="_blank" style="text-decoration: none; color: inherit;">
                    <i class="fa-solid fa-blog"></i>
                    <span>åšå®¢</span>
                </a>
            </div>
        </div>

        <div id="modal-container">
            <div class="modal-window" id="about-me-modal">
                <div class="window-header">
                    <div class="window-controls">
                        <span class="close-btn"></span>
                        <span class="minimize-btn"></span>
                        <span class="maximize-btn"></span>
                    </div>
                    <span class="window-title">å…³äºæˆ‘</span>
                    <span class="close-button-mobile" style="display: none;">å®Œæˆ</span>
                </div>
                <div class="window-content">
                    <h2>ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯æ…•è¾ï¼</h2>
                    <p>ä¸€ä½çƒ­çˆ±å‰ç«¯å¼€å‘å’Œç”¨æˆ·ä½“éªŒçš„å¼€å‘è€…ã€‚</p>
                    <p>æˆ‘ä¸“æ³¨äºä½¿ç”¨ç°ä»£ Web æŠ€æœ¯æ„å»ºé«˜æ•ˆã€ç¾è§‚ã€æ˜“ç”¨çš„ç½‘ç«™å’Œåº”ç”¨ã€‚</p>
                    <h3>æŠ€èƒ½æ ˆï¼š</h3>
                    <ul>
                        <li>**å‰ç«¯ï¼š** HTML, CSS, JavaScript (ES6+), React/Vue/Angular (æ ¹æ®ä½ çš„å®é™…æŠ€èƒ½)</li>
                        <li>**åç«¯ï¼š** Node.js, Python (Django/Flask), PHP (æ ¹æ®ä½ çš„å®é™…æŠ€èƒ½)</li>
                        <li>**æ•°æ®åº“ï¼š** MySQL, PostgreSQL, MongoDB (æ ¹æ®ä½ çš„å®é™…æŠ€èƒ½)</li>
                        <li>**å·¥å…·ï¼š** Git, Webpack, Babel</li>
                    </ul>
                    <p>æœŸå¾…ä¸ä½ ä¸€èµ·æ¢ç´¢ Web çš„æ— é™å¯èƒ½ï¼</p>
                </div>
            </div>

            <div class="modal-window" id="portfolio-modal">
                <div class="window-header">
                    <div class="window-controls">
                        <span class="close-btn"></span>
                        <span class="minimize-btn"></span>
                        <span class="maximize-btn"></span>
                    </div>
                    <span class="window-title">æˆ‘çš„ä½œå“é›†</span>
                    <span class="close-button-mobile" style="display: none;">å®Œæˆ</span>
                </div>
                <div class="window-content">
                    <h3>ç²¾é€‰é¡¹ç›®ï¼š</h3>
                    <div class="project-item">
                        <h4>é¡¹ç›®ä¸€ï¼š[é¡¹ç›®åç§°]</h4>
                        <p>è¿™æ˜¯ä¸€ä¸ªå…³äº [é¡¹ç›®ç®€ä»‹] çš„é¡¹ç›®ã€‚æˆ‘è´Ÿè´£äº† [ä½ çš„èŒè´£] éƒ¨åˆ†ã€‚</p>
                        <p>ä½¿ç”¨äº†æŠ€æœ¯æ ˆï¼š[æŠ€æœ¯æ ˆ]</p>
                        <a href="[é¡¹ç›®é“¾æ¥]" target="_blank">æŸ¥çœ‹é¡¹ç›®</a> | <a href="[GitHubé“¾æ¥]" target="_blank">GitHub</a>
                    </div>
                    <div class="project-item">
                        <h4>é¡¹ç›®äºŒï¼š[é¡¹ç›®åç§°]</h4>
                        <p>è¿™æ˜¯ä¸€ä¸ªå…³äº [é¡¹ç›®ç®€ä»‹] çš„é¡¹ç›®ã€‚ä¸»è¦å®ç°äº† [ä¸»è¦åŠŸèƒ½]ã€‚</p>
                        <p>ä½¿ç”¨äº†æŠ€æœ¯æ ˆï¼š[æŠ€æœ¯æ ˆ]</p>
                        <a href="[é¡¹ç›®é“¾æ¥]" target="_blank">æŸ¥çœ‹é¡¹ç›®</a> | <a href="[GitHubé“¾æ¥]" target="_blank">GitHub</a>
                    </div>
                    <p>æ›´å¤šé¡¹ç›®è¯·è®¿é—®æˆ‘çš„ <a href="https://github.com/your-github" target="_blank">GitHub ä¸»é¡µ</a>ã€‚</p>
                </div>
            </div>

            <div class="modal-window" id="contact-modal">
                <div class="window-header">
                    <div class="window-controls">
                        <span class="close-btn"></span>
                        <span class="minimize-btn"></span>
                        <span class="maximize-btn"></span>
                    </div>
                    <span class="window-title">è”ç³»æˆ‘</span>
                    <span class="close-button-mobile" style="display: none;">å®Œæˆ</span>
                </div>
                <div class="window-content">
                    <h3>ğŸ“¬ æ¬¢è¿è”ç³»æˆ‘ï¼</h3>
                    <p>å¦‚æœä½ å¯¹æˆ‘çš„ä½œå“æ„Ÿå…´è¶£ï¼Œæˆ–è€…æœ‰ä»»ä½•åˆä½œæ„å‘ï¼Œéšæ—¶å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ï¼š</p>
                    <ul>
                        <li>**é‚®ç®±ï¼š** <a href="mailto:your-email@example.com">your-email@example.com</a></li>
                        <li>**GitHubï¼š** <a href="https://github.com/your-github" target="_blank">github.com/your-github</a></li>
                        <li>**é¢†è‹±ï¼š** <a href="https://linkedin.com/in/your-linkedin" target="_blank">linkedin.com/in/your-linkedin</a> (å¦‚æœä½¿ç”¨)</li>
                        <li>**å¾®ä¿¡ï¼š** [ä½ çš„å¾®ä¿¡å·] (å¦‚æœæ„¿æ„å…¬å¼€)</li>
                    </ul>
                    <p>æœŸå¾…ä¸ä½ äº¤æµï¼</p>
                </div>
            </div>
        </div>

        <div class="ios-home-indicator"></div>

        <div class="context-menu" id="desktop-context-menu">
            <div class="context-menu-item" data-action="new-folder">æ–°å»ºæ–‡ä»¶å¤¹</div>
            <div class="context-menu-item" data-action="get-info">æ˜¾ç¤ºç®€ä»‹</div>
            <div class="context-menu-separator"></div>
            <div class="context-menu-item" data-action="change-wallpaper">æ›´æ”¹æ¡Œé¢èƒŒæ™¯...</div>
        </div>

        <div class="context-menu" id="icon-context-menu">
            <div class="context-menu-item" data-action="open-app">æ‰“å¼€</div>
            <div class="context-menu-item" data-action="get-info-app">æ˜¾ç¤ºç®€ä»‹</div>
            <div class="context-menu-separator"></div>
            <div class="context-menu-item" data-action="delete-app">ç§»åˆ°åºŸçº¸ç¯“</div>
        </div>
    </div> <script>
        document.addEventListener('DOMContentLoaded', () => {
            const isMobile = window.innerWidth <= 768;

            const macosBootOverlay = document.getElementById('boot-overlay-macos');
            const iosBootOverlay = document.getElementById('boot-overlay-ios');
            const mainContentWrapper = document.getElementById('main-content-wrapper');

            // --- Initial State Setup ---
            // Hide macOS specific elements if on mobile
            if (isMobile) {
                document.querySelector('.menu-bar').style.display = 'none';
                document.querySelector('.ios-status-bar').style.display = 'flex'; // Show iOS status bar
                document.querySelector('.ios-home-indicator').style.display = 'block'; // Show iOS home indicator
                macosBootOverlay.style.display = 'none'; // Ensure macOS overlay is hidden
                iosBootOverlay.style.display = 'flex'; // Show iOS boot overlay
            } else {
                // Hide iOS specific elements if on desktop
                document.querySelector('.ios-status-bar').style.display = 'none';
                document.querySelector('.ios-home-indicator').style.display = 'none';
                iosBootOverlay.style.display = 'none'; // Ensure iOS overlay is hidden
                macosBootOverlay.style.display = 'flex'; // Show macOS boot overlay
            }

            // Hide the main content initially, regardless of platform
            mainContentWrapper.style.display = 'none';

            // --- Boot Up Animation Logic ---
            const showMainContent = () => {
                mainContentWrapper.style.display = 'block'; // Show the wrapper
                // For iOS, explicitly set display for elements inside if necessary
                if (isMobile) {
                    document.getElementById('desktop').style.display = 'flex';
                    document.getElementById('dock').style.display = 'flex';
                    // No need to explicitly show modal-container as modals are hidden by default
                } else {
                    // For macOS, ensure elements are flex/block as their default CSS might be overridden
                    document.querySelector('.menu-bar').style.display = 'flex';
                    document.getElementById('desktop').style.display = 'flex';
                    document.getElementById('dock').style.display = 'flex';
                }
            };

            if (!isMobile) { // Apply macOS boot for desktop
                macosBootOverlay.addEventListener('animationend', (e) => {
                    if (e.animationName === 'fillProgress') {
                        macosBootOverlay.classList.add('hidden');
                        showMainContent();
                    }
                });
            } else { // Apply iOS boot for mobile
                // Listen for the specific iOS logo animation end
                iosBootOverlay.querySelector('.apple-logo-ios').addEventListener('animationend', () => {
                    iosBootOverlay.classList.add('hidden');
                    showMainContent();
                }, { once: true }); // Ensure this only runs once
            }


            // --- è·å–å…ƒç´  ---
            const dock = document.getElementById('dock');
            const dockItems = document.querySelectorAll('.dock-item');
            const desktop = document.getElementById('desktop');
            const desktopIcons = document.querySelectorAll('.desktop-icon');
            const modalWindows = document.querySelectorAll('.modal-window');
            const closeButtons = document.querySelectorAll('.close-btn');
            const minimizeButtons = document.querySelectorAll('.minimize-btn');
            const maximizeButtons = document.querySelectorAll('.maximize-btn');
            const mobileCloseButtons = document.querySelectorAll('.close-button-mobile');
            const windowHeaders = document.querySelectorAll('.window-header');
            const currentTimeSpan = document.getElementById('current-time');
            const iosCurrentTimeSpan = document.getElementById('ios-current-time');

            const desktopContextMenu = document.getElementById('desktop-context-menu');
            const iconContextMenu = document.getElementById('icon-context-menu');
            let activeContextMenu = null; // Track which context menu is open

            // --- æ—¶é—´æ˜¾ç¤º ---
            function updateTime() {
                const now = new Date();
                const options = { hour: '2-digit', minute: '2-digit', hour12: false };
                currentTimeSpan.textContent = now.toLocaleTimeString('zh-CN', options);
                iosCurrentTimeSpan.textContent = now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit', hour12: false });
            }
            setInterval(updateTime, 1000);
            updateTime();

            // --- çª—å£ç®¡ç† ---
            function openModal(modalId) {
                // Hide all currently active windows
                modalWindows.forEach(modal => {
                    if (modal.classList.contains('active')) {
                        modal.classList.remove('active');
                        modal.classList.add('hidden'); // Add hidden class after active is removed
                        modal.style.zIndex = 997;
                    }
                });

                const targetModal = document.getElementById(modalId);
                if (targetModal) {
                    targetModal.classList.remove('hidden'); // Remove hidden class first
                    // Force reflow to restart animation
                    void targetModal.offsetWidth;
                    targetModal.classList.add('active');
                    targetModal.style.zIndex = 998;
                }
            }

            function closeOrMinimizeModal(modal, isMinimize = false) {
                if (isMinimize) {
                    modal.classList.add('minimizing');
                    // After the minimize animation, completely hide it
                    modal.addEventListener('transitionend', function handler() {
                        modal.classList.remove('active', 'minimizing');
                        modal.classList.add('hidden');
                        modal.removeEventListener('transitionend', handler);
                    });
                } else {
                    modal.classList.remove('active');
                    modal.addEventListener('transitionend', function handler() {
                        modal.classList.add('hidden');
                        modal.removeEventListener('transitionend', handler);
                    }, { once: true });
                }
            }

            // --- äº‹ä»¶ç›‘å¬å™¨ï¼šæ‰“å¼€æ¨¡æ€çª—å£ ---
            dockItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    if (item.querySelector('a') && e.target.tagName !== 'I') { // Allow direct link clicks
                        return;
                    }
                    e.preventDefault(); // Prevent default link behavior if it's an icon click
                    const targetId = item.dataset.target;
                    if (targetId) {
                        openModal(targetId);
                    }
                });
            });

            desktopIcons.forEach(icon => {
                icon.addEventListener('click', () => {
                    const targetId = icon.dataset.modalTarget;
                    if (targetId) {
                        openModal(targetId);
                    }
                });
            });

            // --- äº‹ä»¶ç›‘å¬å™¨ï¼šå…³é—­/æœ€å°åŒ–/æœ€å¤§åŒ–æ¨¡æ€çª—å£ ---
            closeButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal-window');
                    if (modal) {
                        closeOrMinimizeModal(modal);
                    }
                });
            });

            minimizeButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal-window');
                    if (modal) {
                        closeOrMinimizeModal(modal, true);
                    }
                });
            });

            // For now, maximize does the same as close. You can expand this.
            maximizeButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal-window');
                    if (modal) {
                        // Implement full screen or snap to grid logic here
                        alert('æœ€å¤§åŒ–åŠŸèƒ½å¾…å®ç°ï¼'); // Placeholder
                    }
                });
            });

            mobileCloseButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal-window');
                    if (modal) {
                        closeOrMinimizeModal(modal);
                    }
                });
            });

            // --- æ¨¡æ€çª—å£æ‹–æ‹½ (macOS only) ---
            windowHeaders.forEach(header => {
                let isDragging = false;
                let offsetX, offsetY;
                const modal = header.closest('.modal-window');

                if (!isMobile) { // Only enable drag for desktop
                    header.addEventListener('mousedown', (e) => {
                        isDragging = true;
                        offsetX = e.clientX - modal.getBoundingClientRect().left;
                        offsetY = e.clientY - modal.getBoundingClientRect().top;
                        modal.style.cursor = 'grabbing';
                        modal.style.transition = 'none'; // Disable transition during drag
                    });

                    document.addEventListener('mousemove', (e) => {
                        if (!isDragging) return;
                        modal.style.left = `${e.clientX - offsetX}px`;
                        modal.style.top = `${e.clientY - offsetY}px`;
                    });

                    document.addEventListener('mouseup', () => {
                        isDragging = false;
                        modal.style.cursor = 'grab';
                        modal.style.transition = ''; // Restore transition
                    });
                }
            });

            // --- çª—å£æ¿€æ´»ç®¡ç† (ç‚¹å‡»çª—å£ä½¿å…¶ç½®é¡¶) ---
            modalWindows.forEach(modal => {
                modal.addEventListener('mousedown', () => {
                    modalWindows.forEach(m => {
                        if (m !== modal) {
                            m.style.zIndex = 997;
                        }
                    });
                    modal.style.zIndex = 998;
                });
            });

            // --- macOS Dock Magnification Effect ---
            if (!isMobile) {
                dock.addEventListener('mousemove', (e) => {
                    const dockRect = dock.getBoundingClientRect();
                    const mouseX = e.clientX - dockRect.left; // Mouse X relative to dock

                    dockItems.forEach(item => {
                        const itemRect = item.getBoundingClientRect();
                        const itemCenterX = (itemRect.left + itemRect.right) / 2 - dockRect.left;

                        // Calculate distance from mouse to item center
                        let distance = Math.abs(mouseX - itemCenterX);

                        // Define the magnification zone (e.g., 100px around mouse)
                        const magnificationZone = 120; // Adjust this value
                        let scale = 1;

                        if (distance < magnificationZone) {
                            // Map distance to a scale factor (closer = larger)
                            // Using a cubic bezier for a smoother, more "bouncy" falloff
                            // f(x) = (1 - x/magnificationZone)^3 + 1
                            scale = 1 + 0.8 * (1 - distance / magnificationZone); // Max scale 1.8 (adjust as needed)
                        }
                        item.style.transform = `scale(${scale})`;
                    });
                });

                dock.addEventListener('mouseleave', () => {
                    dockItems.forEach(item => {
                        item.style.transform = 'scale(1)'; // Reset all items to normal size
                    });
                });
            }

            // --- Right-Click Context Menu ---
            function showContextMenu(menu, x, y, targetElement) {
                hideContextMenu(); // Hide any existing menu
                activeContextMenu = menu;
                menu.style.left = `${x}px`;
                menu.style.top = `${y}px`;
                menu.style.display = 'block';
                menu.dataset.targetElementId = targetElement ? targetElement.id : ''; // Store target ID

                // Ensure menu doesn't go off screen
                const menuRect = menu.getBoundingClientRect();
                if (menuRect.right > window.innerWidth) {
                    menu.style.left = `${x - menuRect.width}px`;
                }
                if (menuRect.bottom > window.innerHeight) {
                    menu.style.top = `${y - menuRect.height}px`;
                }
            }

            function hideContextMenu() {
                if (activeContextMenu) {
                    activeContextMenu.style.display = 'none';
                    activeContextMenu.removeAttribute('data-target-element-id');
                    activeContextMenu = null;
                }
            }

            // Global click listener to hide context menu when clicking outside
            document.addEventListener('click', (e) => {
                if (activeContextMenu && !activeContextMenu.contains(e.target)) {
                    hideContextMenu();
                }
            });

            // Desktop right-click
            desktop.addEventListener('contextmenu', (e) => {
                e.preventDefault(); // Prevent default browser context menu
                if (isMobile) return; // Disable for mobile
                showContextMenu(desktopContextMenu, e.clientX, e.clientY, null);
            });

            // Desktop icon right-click
            desktopIcons.forEach(icon => {
                icon.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    if (isMobile) return;
                    showContextMenu(iconContextMenu, e.clientX, e.clientY, icon);
                });
            });

            // Handle context menu actions
            desktopContextMenu.addEventListener('click', (e) => {
                const action = e.target.dataset.action;
                if (action === 'new-folder') {
                    alert('æ–°å»ºæ–‡ä»¶å¤¹åŠŸèƒ½å¾…å®ç°ï¼');
                } else if (action === 'get-info') {
                    alert('æ˜¾ç¤ºç®€ä»‹åŠŸèƒ½å¾…å®ç°ï¼');
                } else if (action === 'change-wallpaper') {
                    changeDesktopBackground();
                }
                hideContextMenu();
            });

            iconContextMenu.addEventListener('click', (e) => {
                const action = e.target.dataset.action;
                const targetIconId = iconContextMenu.dataset.targetElementId;
                const targetIcon = document.getElementById(targetIconId);
                const modalTarget = targetIcon ? targetIcon.dataset.modalTarget : null;

                if (action === 'open-app' && modalTarget) {
                    openModal(modalTarget);
                } else if (action === 'get-info-app') {
                    alert(`æ˜¾ç¤º "${targetIcon.querySelector('span').textContent}" çš„ç®€ä»‹åŠŸèƒ½å¾…å®ç°ï¼`);
                } else if (action === 'delete-app') {
                    if (confirm(`ç¡®å®šè¦å°† "${targetIcon.querySelector('span').textContent}" ç§»åˆ°åºŸçº¸ç¯“å—ï¼Ÿ`)) {
                        targetIcon.remove(); // Simple removal, no actual trash
                    }
                }
                hideContextMenu();
            });

            // --- Dynamic Background Change (Placeholder) ---
            const backgrounds = [
                'https://4kwallpapers.com/images/walls/thumbs_2t/5893.jpg', // Original macOS
                'https://images.unsplash.com/photo-1542435503-956c469947f6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80', // Nature
                'https://images.unsplash.com/photo-1518608821424-69db380a0494?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80', // Abstract
                'https://images.unsplash.com/photo-1621243831776-b6e828d5d3b6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80' // Dark abstract
            ];
            let currentBackgroundIndex = 0;

            function changeDesktopBackground() {
                currentBackgroundIndex = (currentBackgroundIndex + 1) % backgrounds.length;
                document.body.style.backgroundImage = `url('${backgrounds[currentBackgroundIndex]}')`;
                // Add a subtle transition for background change if desired
                document.body.style.transition = 'background-image 0.5s ease-in-out';
            }

            // Bind change wallpaper icon click
            const changeBgIcon = document.getElementById('change-bg-icon');
            if (changeBgIcon) {
                changeBgIcon.addEventListener('click', changeDesktopBackground);
            }

            // --- iOS Desktop Icon Dragging (Basic) ---
            if (isMobile) {
                let activeDragIcon = null;
                let initialX, initialY;
                let currentX, currentY;
                let xOffset = 0, yOffset = 0;

                desktopIcons.forEach(icon => {
                    icon.addEventListener('touchstart', (e) => {
                        activeDragIcon = icon;
                        icon.classList.add('dragging'); // Visual feedback for dragging
                        initialX = e.touches[0].clientX - xOffset;
                        initialY = e.touches[0].clientY - yOffset;
                        // Bring to front while dragging
                        icon.style.zIndex = 10;
                        // Prevent scrolling while dragging
                        document.body.style.overflow = 'hidden';
                    });

                    icon.addEventListener('touchmove', (e) => {
                        if (activeDragIcon) {
                            e.preventDefault(); // Prevent default touch behavior (scrolling, zooming)
                            currentX = e.touches[0].clientX - initialX;
                            currentY = e.touches[0].clientY - initialY;
                            xOffset = currentX;
                            yOffset = currentY;

                            activeDragIcon.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
                        }
                    });

                    icon.addEventListener('touchend', () => {
                        if (activeDragIcon) {
                            activeDragIcon.classList.remove('dragging');
                            activeDragIcon.style.zIndex = ''; // Reset z-index
                            // Reset transform for next drag. For persistent placement, you'd save positions.
                            activeDragIcon.style.transform = 'translate3d(0, 0, 0)';
                            activeDragIcon = null;
                            xOffset = 0;
                            yOffset = 0;
                            document.body.style.overflow = ''; // Restore scrolling
                        }
                    });
                });
            }

            // --- Dock Bounce for Applications when Opened (macOS only) ---
            if (!isMobile) {
                const bounce = (item) => {
                    item.style.animation = 'dockBounce 0.4s ease-in-out';
                    item.addEventListener('animationend', () => {
                        item.style.animation = ''; // Remove animation after it ends
                    }, { once: true });
                };

                // Add bounce animation keyframe
                const styleSheet = document.styleSheets[0];
                const dockBounceKeyframes = `@keyframes dockBounce {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.15); }
                }`;
                styleSheet.insertRule(dockBounceKeyframes, styleSheet.cssRules.length);


                dockItems.forEach(item => {
                    const targetModalId = item.dataset.target;
                    if (targetModalId) {
                        const modal = document.getElementById(targetModalId);
                        if (modal) {
                            modal.addEventListener('transitionstart', () => {
                                // Only bounce if the window is being opened (opacity goes from 0 to 1)
                                if (!modal.classList.contains('active')) {
                                    bounce(item);
                                }
                            });
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
